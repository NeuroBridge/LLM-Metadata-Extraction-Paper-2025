Title.
CLASSIFICATION OF SCHIZOPHRENIA AND BIPOLAR PATIENTS USING STATIC AND DYNAMIC RESTING-STATE FMRI BRAIN CONNECTIVITY.
Abstract.
Recently, functional network connectivity (FNC, defined as the temporal correlation among spatially distant brain networks) has been used to examine the functional organization of brain networks in various psychiatric illnesses. Dynamic FNC is a recent extension of the conventional FNC analysis that takes into account FNC changes over short periods of time. While such dynamic FNC measures may be more informative about various aspects of connectivity, there has been no detailed head-to-head comparison of the ability of static and dynamic FNC to perform classification in complex mental illnesses. This paper proposes a framework for automatic classification of schizophrenia, bipolar and healthy subjects based on their static and dynamic FNC features. Also, we compare cross-validated classification performance between static and dynamic FNC. Results show that the dynamic FNC significantly outperforms the static FNC in terms of predictive accuracy, indicating that features from dynamic FNC have distinct advantages over static FNC for classification purposes. Moreover, combining static and dynamic FNC features does not significantly improve the classification performance over the dynamic FNC features alone, suggesting that static FNC does not add any significant information when combined with dynamic FNC for classification purposes. A three-way classification methodology based on static and dynamic FNC features discriminates individual subjects into appropriate diagnostic groups with high accuracy. Our proposed classification framework is potentially applicable to additional mental disorders.
1. Introduction.
Functional connectivity (FC) can be quantified using a variety of different neuroimaging techniques. A commonly used measure is functional magnetic resonance imaging (fMRI), which measures synchronized brain activity via blood oxygenation and infers functional interactions among different brain regions. FC, defined as temporal correlation (or other types of statistical dependency) among spatially distant brain regions, has recently been used to examine the functional organization and temporal dependencies among these remote brain regions. Different analytic tools have been applied to resting-state fMRI data to describe brain functional connectivity. Two widely used FC approaches are (i) seed-based analysis and (ii) purely data-driven methods, such as ICA. FC can also be investigated at the network level using spatial independent component analysis (ICA), and connectivity among spatial components is referred to as functional network connectivity (FNC).
The majority of FNC studies are primarily based on the assumption that FNC is stationary throughout the entire scan session (or at least stationary during a given task or resting-state condition). Static FNC analysis overlooks the fact that individual subjects are likely to engage in slightly different mental activities at different instances in time. Also evidence of dynamic fluctuation in FC from several studies supports the idea of dynamic changes in FC during the experimental period. More recently, studies have started utilizing the powerful information contained within the temporal features of spontaneous FC of BOLD signals. Connectivity dynamics capture uncontrolled but reoccurring patterns of interactions among intrinsic networks during task engagement or at rest. These studies provide results that cannot be detected with static functional connectivity analyses.
There is an increasing interest in designing robust and accurate techniques to classify subjects into groups using functional imaging data. For example, previous studies showed the use of functional connectivity-based features for classification of schizophrenia and bipolar patients at the individual level. used an atlas-based method to extract mean time-courses of 116 brain regions in the resting-state for both healthy controls and schizophrenia subjects. The correlation between these time-courses made the feature vector for each subject. By applying feature selection and dimensionality reduction methods, they reduced the dimensionality down to three where they classified patients from controls with a high accuracy. proposed a classification approach for schizophrenia patients based on fMRI time-series from the voxels showing between-group temporal dissimilarity using leave-one-out cross-validation method. Another study combined both structural and functional MRI data for classification of schizophrenia patients and created a training set by projecting the high dimensional data onto a lower dimensional space using the principle component analysis (PCA), achieving a high classification accuracy. A recent study performed automatic classification of schizophrenia using both structural and functional MRI features, and showed that better classification accuracy could be achieved by using both MRI features, compared to using only a single feature. However, only a few studies have focused on classification analyses of both schizophrenia and bipolar disorder patients. In, temporal lobe and default mode networks were used as features using a leave-one-out cross-validation framework, and classified schizophrenia and bipolar patients at individual level. In another classification study, a support vector machine (SVM) was applied on the verbal fluency task-based patterns of regional brain responses to identify schizophrenia and bipolar patients at the individual level. To our best knowledge, no such study has provided a detailed comparison of both static and dynamic FNC features in a cross-validated classification analysis.
In this work, we conducted a classification study of schizophrenia, bipolar and healthy subjects using static and dynamic FNC features, as well as combined FNC features from both FNC analyses. Several previous studies have shown that schizophrenia and bipolar patients can be discriminated at group-level by using the information on dysfunctional integration of the brain.We hypothesized that disrupted functional integration in schizophrenia and bipolar patients as captured by FNC analysis reveal powerful information for automatic discriminative analysis at subject-level. We expected some connectivity measures to be better captured in a static model and others in a dynamic model. Static FNC provides information about the overall mean connectivity and may be more optimal for connectivity that is persistent across the entire experiment than a dynamic FNC approach. On the other hand, information on local connectivity changes at different time windows will be better captured by dynamic FNC. Thus, we hypothesize that both static and dynamic FNC methods capture complementary aspects of connectivity, and combining static and dynamic FNC features will improve classification performance beyond the achievable performance from each type of these features individually. We present machine learning techniques to effectively combine these two types of features for accurate classification of schizophrenia, bipolar and healthy controls.
2. Materials and methods.
2.1 Participants.
Before preprocessing, we had raw resting-state fMRI data from 273 subjects (HC= 135, SZ= 87 and BP=51). After matching for age, and based on our exclusion criterion (see section 2.3 for details), we eliminated 114 subjects from the final analysis and had 159 subjects in total. We assessed these 159 subjects comprising 61 screened healthy controls [HC, age 35.44 ± 11.57 (range), 28 females], 60 patients diagnosed with schizophrenia or schizoaffective disorder (SZ, age 35.85 ± 12.01, 13 females) and 38 bipolar subjects (BP, age 38.96 ± 10.90, 20 females), matched for age with no significant differences among three groups (age: p= 0.303, F= 1.2031, DF=(2,156)). Significant differences in sex among three groups were found (p= 0.002, = χ2= 11.81, DF=(2,156)). Diagnoses were based on detailed medical and psychiatric history, chart reviews, and the Structured Clinical Interview for DSM IV-TR Disorders. None were acutely ill at the time of scanning. The bipolar patients group consisted of a mixture of individuals experiencing psychotic and non-psychotic symptoms by history.
2.2. Data Acquisition.
Resting-state fMRI scans were acquired at the Institute of Living, Hartford, CT, USA on a 3T Siemens Allegra head-only scanner with 40mT/m gradients and a quadrature head coil. T2* - weighted functional images were acquired using gradient echo planar imaging (EPI) method with repetition time (TR)=1.5 s, echo time (TE)=27ms, field of view=24 cm, acquisition matrix 64×64, flip angle=70 degrees, voxel size=3.75mm×3,75mm×4mm, slice thickness=4 mm, gap=1 mm, number of slices=29, 210 frames and ascending acquisition. Subjects were instructed to keep their eyes open, look at a fixation cross on a monitor display and to rest quietly during the scan session.
2.3 Data Pre-processing.
Functional images were pre-processed using an automated pipeline based around SPM 5 (http://www.fil.ion.ucl.ac.uk/spm/software/spm5). Pre-processing included the removal of the first four image volumes to avoid T1 equilibration effects, realignment using INRIalign (http://www-sop.inria.fr/epidaure/Collaborations/IRMf/INRIAlign.html), slice-timing correction using the middle slice as the reference frame, spatial normalization into Montreal Neurological Institute (MNI) space (http://www.mni.mcgill.ca/), reslicing to 3 mm × 3 mm × 3 mm voxels, and smoothing with a Gaussian kernel (FWHM = 5 mm). Voxel timeseries were z-scored to normalize variance across space, minimizing possible bias in subsequent variance-based data reduction steps.
In order to limit the impact of motion we excluded from analysis subject data with a maximum translation of >2 mm or with signal-to-fluctuation-noise ratio (SFNR) <275. The final 159 subjects comprised of patient and control groups were age matched (matched age ranging from 17 years to 65 years).
Also, to analyze if there is any systematic difference in motion across the three groups, we have computed the mean framewise displacement (FD) (calculated as the total absolute displacement in all dimensions) for 159 subjects. Results from one-way ANOVA showed significant group differences in mean FD groups (P-value=0.0369). However, three outliers were identified from the healthy group (subjects with high mean FD values (mean FD>1mm.) After removing these three outliers, we checked for mean FD group differences, and found no significant group difference (p-value=0.3172). Additional post-processing steps were taken to mitigate against residual motion effects as described in section 2.4.
2.4 Group ICA and Post-processing.
Imaging data were decomposed into functional networks using a group-level spatial independent component analysis (ICA). Group ICA was performed using the GIFT toolbox (http://mialab.mrn.org/software/gift/). In order to obtain functional parcellation, we used a high model order ICA (number of components, C=100) to decompose the functionally homogeneous cortical and subcortical regions exhibiting temporally coherent activity. In the subject-specific data reduction principle component analysis (PCA) step, 120 principal components were retained (retaining > 99% of the variance of the data). Group data reduction retained C= 100 PCs using the expectation-maximization (EM) algorithm as implemented in the GIFT toolbox. The Infomax ICA algorithm was repeated 20 times in ICASSO and the resulting components were clustered to estimate the reliability of the decomposition. Subject-specific spatial maps (SMs) and time-courses (TCs) were estimated using the GICA1 back-reconstruction method based on PCA compression and projection.
Additional post-processing steps including linear, quadratic and cubic detrending, multiple regression of the six realignment parameters and their temporal derivatives, interpolation of detected outliers, and low-pass filtering with a high frequency cutoff of 0.15 Hz were applied to the component TCs in order to remove trends associated with scanner drift and movement-related artifacts. We detected outliers based on the median absolute deviation, as implemented in 3D DESPIKE (http://afni.nimh.nih.gov/afni). Outliers were replaced with the best estimate using a third-order spline fit to the clean portions of the TCs. As a final step in post-processing, we normalized the variance of each TC, thus covariance matrices (below) correspond to correlation matrices.
2.5 FNC Estimation.
2.5.1 Static FNC Estimation.
The static FNC (SFNC) for each subject was estimated from the TC matrix, as the C×C sample covariance matrix.
2.5.2 Dynamic FNC Estimation.
In addition to the standard FNC analyses, we computed correlations between ICN time-courses using a sliding temporal window (Tukey window) having a width of 33 seconds (22 times of TR); sliding in steps of 1 TR), resulting in W=180 windows to capture the variability in connectivity. To characterize the full covariance matrix, we estimated covariance from the regularized precision matrix or the inverse covariance matrix. Following the graphical LASSO method of, we placed a penalty on the L1 norm of the precision matrix to promote sparsity. The regularization parameter lambda was optimized separately for each subject by evaluating the log-likelihood of unseen data (windowed covariance matrices from the same subject) in a cross-validation framework. Final dynamic FNC (DFNC) estimates for each window were concatenated to form a C×C×W array representing the changes in covariance (correlation) between components as a function of time.
2.6 Classification Framework.
We evaluated the classification performance for static FNC, dynamic FNC and a combination of both static and dynamic FNC (see Fig.2 for illustration of the proposed approaches). Our main focus was to extract reliable features from the FNC matrices and apply proposed classification methods, rather than investigating the performance on different classifiers. For all of the FNC-based classification approaches, we used a linear support vector machine (SVM) classifier to evaluate the classification performance. Also, to obtain the 10 groups in 10-fold cross-validation, one split was performed and those same folds were used for static, dynamic and combined classification approaches
2.6.1 Static FNC Approach.
In order to reduce the dimensionality and extract reliable features from this high-dimensional feature vector, we used the double input symmetric relevance (DISR) method during the cross-validation step. DISR is a mutual information based method which is designed to extract features by finding a combination of variables that can return more information on the output class than the sum of the information returned by each of the variables taken individually. For classification using SFNC features, the DISR method was run once per cross-validation fold. We used a 10-fold cross-validation strategy for estimating the generalization error of the proposed classifier. The details on the feature selection process using DISR are given in the supplementary Figure S1 and supplementary section S1. In each cross-validation run, 100 features were selected using the DISR method from the training samples. A linear SVM classifier was then trained using the features from training data and then tested on held out testing samples (the same 100 features were selected from the testing data).
2.6.2 Dynamic FNC Approach.
For classification using the dynamic FNC matrix, we also used a 10-fold cross-validation for estimating the generalization error. In each cross-validation run, we performed group-wise k-means clustering on dynamic FNC matrix from the training samples. For each of the three groups, we obtained 5 cluster centroids or states. We then grouped these states together and formed a regression matrix with 15 states in total. We call these 15 states the feature states. Note that at each time point the FNC matrix is assumed to be a linear combination of these states. Then for each FNC time point, we regressed out the dynamic FNC matrix against these 15 feature states and obtained the corresponding regression coefficients. We used the mean of these regression coefficients and finalized 15 features for each subject for classification. Details on dynamic feature selection method are provided in the supplementary section S2 and supplementary Figure S2. A linear SVM was then trained using the training features and then tested on held out testing samples.
2.6.3 Combined Static and Dynamic FNC Approach.
For the combined static and dynamic FNC approach, 100 features from static FNC feature vector after dimensionality reduction (as mentioned above in static FNC approach section), and 15 beta coefficient features from the dynamic FNC after regression against the states (obtained similar way as mentioned in dynamic FNC approach section) were used for classification purpose. Also SVM classifiers and a 10-fold cross-validation strategy were applied in a similar way as mentioned above for other two classification approaches.